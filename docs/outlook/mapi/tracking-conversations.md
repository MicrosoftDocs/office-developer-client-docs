---
title: "Tracking Conversations"
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 0500dee8-a39d-45ce-87b1-c515e92e083d
description: "Last modified: July 23, 2011"
 
 
---

# Tracking Conversations

 **Last modified:** July 23, 2011 
  
 * **Applies to:** Outlook * 
  
Conversation tracking is collecting responses to a message. Clients should set two properties that aid in tracking conversations:
  
- **PR_CONVERSATION_TOPIC** ( [PidTagConversationTopic](pidtagconversationtopic-canonical-property.md))
    
    **PR_CONVERSATION_TOPIC** is the normalized subject of the message, the subject without the prefix strings. Set this property to the value of the message's **PR_NORMALIZED_SUBJECT** ( [PidTagNormalizedSubject](pidtagnormalizedsubject-canonical-property.md)) property. 
    
- **PR_CONVERSATION_INDEX** ( [PidTagConversationIndex](pidtagconversationindex-canonical-property.md))
    
    **PR_CONVERSATION_INDEX** indicates the position of the message within a particular conversation. It is a client's reponsibility to set **PR_CONVERSATION_INDEX** for each outgoing message, whether it is a new message, a forwarded message, or a reply. Clients can set this property manually or call [ScCreateConversationIndex](sccreateconversationindex.md), a utility function provided by MAPI. 
    
 **ScCreateConversationIndex** generates the value of a conversation index for any outgoing message. **ScCreateConversationIndex** implements the index as a header block that is 22 bytes in length, followed by zero or more child blocks each 5 bytes in length. 
  
The header block is composed of 22 bytes, divided into three parts:
  
- One reserved byte. Its value is 1.
    
- Five bytes for the current system time converted to the [FILETIME](filetime.md) structure format. 
    
- Sixteen bytes holding a [GUID](guid.md), or globally unique identifier.
    
Each child block is composed of 5 bytes, divided as follows:
  
- One bit containing a code representing the difference between the current time and the time stored in the header block. This bit will be 0 if the difference is less than .02 second and greater than two years and 1 if the difference is less than one second and greater than 56 years.
    
- Thirty one bits containing the difference between the current time and the time in the header block expressed in **FILETIME** units.This part of the child block is produced using one of two strategies, depending on the value of the first bit. If this bit is zero, **ScCreateConversationIndex** discards the high 15 bits and the low 18 bits. If this bit is one, the function discards the high 10 bits and the low 23 bits. 
    
- Four bits containing a random number generated by calling the Win32 function [GetTickCount](http://msdn.microsoft.com/en-us/library/ms724408%28VS.85%29.aspx).
    
- Four bits containing a sequence count that is taken from part of the random number.
    
If you choose to set the conversation indexes of messages manually, consider the following suggestions:
  
1. Keep differences in the respondents' time zones transparent; use UTC times rather than local time.
    
2. Indent each conversation group by the same amount.
    
3. Sort responses to the same message date.
    
4. Separate threads started at different times that happen to share the same topic. 
    
5. To implement a categorized sort so that messages are grouped by topic, sort by **PR_CONVERSATION_TOPIC** first and then by **PR_CONVERSATION_INDEX**. To present the results of the sort, set the **PR_DEPTH** ( [PidTagDepth](pidtagdepth-canonical-property.md)) property to 0 for messages with a conversation index that is 22 bytes in length. Then, for every 5-byte increment in the length, increment the value of the **PR_DEPTH** property by one. 
    
The PR_ORIGINAL group of properties can also be used for conversation tracking. Set these properties to link reply or forwarded messages to the original message. All of the PR_ORIGINAL properties are optional. If you do not explicitly set, for example, **PR_ORIGINAL_AUTHOR_ENTRYID** ( [PidTagOriginalAuthorEntryId](pidtagoriginalauthorentryid-canonical-property.md)), the message store provider can use the default value, or the value of the **PR_SENDER_ENTRYID** ( [PidTagSenderEntryId](pidtagsenderentryid-canonical-property.md)) property. Likewise, if you do not set **PR_ORIGINAL_AUTHOR_NAME** or **PR_ORIGINAL_SUBMIT_TIME** ( [PidTagOriginalSubmitTime](pidtagoriginalsubmittime-canonical-property.md)), these properties can default to the values of the **PR_SENDER_NAME** ( [PidTagSenderName](pidtagsendername-canonical-property.md)) and **PR_CLIENT_SUBMIT_TIME** ( [PidTagClientSubmitTime](pidtagclientsubmittime-canonical-property.md)) properties, respectively. 
  

