---
title: "IMAPISupportReadReceipt"
 
 
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPISupport.ReadReceipt
api_type:
- COM
ms.assetid: ef31b61a-93b6-4ae8-bc71-f5ef5caf43f4
description: "Last modified: July 23, 2011"
---

# IMAPISupport::ReadReceipt

  
  
**Applies to**: Outlook 
  
Generates a read or nonread report for a message.
  
```cpp
HRESULT ReadReceipt(
ULONG ulFlags,
LPMESSAGE lpReadMessage,
LPMESSAGE FAR * lppEmptyMessage
);
```

## Parameters

 _ulFlags_
  
> [in] A bitmask of flags that controls how the read or nonread report is generated. The following flag can be set:
    
MAPI_NON_READ 
  
> A nonread report is generated. If MAPI_NON_READ is not set, a read report is generated.
    
 _lpReadMessage_
  
> [in] A pointer to the message about which the report should be generated.
    
 _lppEmptyMessage_
  
> [in, out] On input,  _lppEmptyMessage_ points to a pointer to an empty message. On output,  _lppEmptyMessage_ points to a pointer to the report message. 
    
## Return value

S_OK 
  
> The report was successfully generated.
    
## Remarks

The **IMAPISupport::ReadReceipt** method is implemented only for message store provider support objects. Message store providers call **ReadReceipt** to instruct MAPI to generate a read or nonread report for the message pointed to by the  _lpReadMessage_ parameter. 
  
## Notes to callers

Call **ReadReceipt** when the **PR_READ_RECEIPT_REQUESTED** ([PidTagReadReceiptRequested](pidtagreadreceiptrequested-canonical-property.md)) property is set and one of the following conditions is true:
  
- The message has been read.
    
- The message has been moved.
    
- The message has been copied.
    
- The message's [IMessage::SetReadFlag](imessage-setreadflag.md) method has been called. 
    
Do not call **ReadReceipt** when a message is deleted. 
  
A read or nonread report should be sent only once for a message. Keep track of a message's read status and do not send multiple reports for a single message.
  
If the  _lppEmptyMessage_ parameter points to a valid report message when MAPI returns from **ReadReceipt**, call the [IMessage::SubmitMessage](imessage-submitmessage.md) method to send the message and then release the pointer by calling its **IUnknown:s:Release** method. 
  
If **ReadReceipt** fails, the message should be released without being submitted. If you store the message's read status, you can attempt to generate the read or nonread report at a later time. 
  
You can either hide or display read and nonread reports generated by stores in your folders. Storing read and nonread reports in hidden folders enables you to implement tighter security.
  
## See also



[IMAPIFolder::DeleteMessages](imapifolder-deletemessages.md)
  
[IMessage::SubmitMessage](imessage-submitmessage.md)
  
[PidTagReadReceiptRequested Canonical Property](pidtagreadreceiptrequested-canonical-property.md)
  
[IMAPISupport : IUnknown](imapisupportiunknown.md)

