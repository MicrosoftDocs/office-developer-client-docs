---
title: "IMAPISupportNewEntry"
 
 
manager: lindalu
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.service: office-online-server
ms.localizationpriority: medium
api_name:
- IMAPISupport.NewEntry
api_type:
- COM
ms.assetid: 588d002b-8412-4ab9-9757-04ad89e0a6f8
---

# IMAPISupport::NewEntry

  
  
**Applies to**: Outlook 2013 | Outlook 2016 
  
Adds a new recipient directly to an address book container or to the recipient list of an outgoing message.
  
```cpp
HRESULT NewEntry(
  ULONG_PTR ulUIParam,
  ULONG ulFlags,
  ULONG cbEIDContainer,
  LPENTRYID lpEIDContainer,
  ULONG cbEIDNewEntryTpl,
  LPENTRYID lpEIDNewEntryTpl,
  ULONG FAR * lpcbEIDNewEntry,
  LPENTRYID FAR * lppEIDNewEntry
);
```

## Parameters

 _ulUIParam_
  
> [in] A handle to the parent window of the dialog box.
    
 _ulFlags_
  
> [in] Reserved; must be zero.
    
 _cbEIDContainer_
  
> [in] The byte count in the entry identifier pointed to by the  _lpEIDContainer_ parameter. 
    
 _lpEIDContainer_
  
> [in] A pointer to the entry identifier of the container to receive the new entry. If  _cbEIDContainer_ is 0 and  _lpEIDContainer_ is NULL, **NewEntry** creates a one-off entry identifier that is the same type as is generated by a call to the [IMAPISupport::CreateOneOff](imapisupport-createoneoff.md) method. 
    
 _cbEIDNewEntryTpl_
  
> [in] The byte count in the entry identifier pointed to by the  _lpEIDNewEntryTpl_ parameter. 
    
 _lpEIDNewEntryTpl_
  
> [in] A pointer to the entry identifier of the template to be used to create the new entry. If  _cbEIDNewEntryTpl_ is 0 and  _lpEIDNewEntryTpl_ is NULL, **NewEntry** displays a dialog box that enables the user to select from a list of templates for adding new entries. 
    
 _lpcbEIDNewEntry_
  
> [out] A pointer to the byte count in the entry identifier pointed to by the  _lppEIDNewEntry_ parameter. 
    
 _lppEIDNewEntry_
  
> [out] A pointer to a pointer to the entry identifier of the newly created entry.
    
## Return value

S_OK 
  
> The new entry was successfully created.
    
## Remarks

The **IMAPISupport::NewEntry** method is implemented for address book provider support objects. Address book providers call **NewEntry** to create a new address book entry to be added directly into a container or to be used to address an outgoing message. 
  
## Notes to callers

If you want the new entry to be added to a specific container, set  _lpEIDContainer_ to the container's entry identifier and  _cbEIDContainer_ to the byte count in the entry identifier. 
  
If you want the new entry to be added to the recipient list of an outgoing message, set  _lpEIDContainer_ to NULL and  _cbEIDContainer_ to 0. 
  
If you want to allow the user of a client application to select the type of entry to be created, pass 0 in  _cbEIDNewEntryTpl_ and NULL in  _lpEIDNewEntryTpl_. **NewEntry** displays the MAPI one-off table, a list of templates that MAPI and each of the address book providers in the session support. Each template can create a recipient entry for one or more address types. 
  
If you want to retain the entry identifier of the new entry, pass valid pointers in the _lpcbEIDNewEntry_ and  _lppEIDNewEntry_ parameters. You are responsible for freeing this entry identifier when you are finished with it by calling the [MAPIFreeBuffer](mapifreebuffer.md) function. 
  
To use a particular template to add a new entry to a modifiable container, use the following procedure:
  
1. Call the [IMAPISupport::OpenEntry](imapisupport-openentry.md) method to open the destination container, and set the  _lpEntryID_ parameter to the entry identifier of the container. 
    
2. Call the destination container's [IMAPIProp::OpenProperty](imapiprop-openproperty.md) method, and set the  _ulPropTag_ parameter to **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) and the  _lpiid_ parameter to IID_IMAPITable. The container will return a one-off table that lists all of the templates that it supports for creating new entries. 
    
3. Retrieve the row that represents the template for the particular type of entry you want to create. The **PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md)) column indicates the address type that is supported by the template. 
    
4. Call **IMAPISupport::NewEntry** and set the  _lpEIDNewEntryTpl_ parameter to the entry identifier of the selected template. The entry identifier is the **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) column from the template's row in the one-off table. Pass 0 in  _cbEIDContainer_ and NULL in  _lpEIDContainer_. Pass a valid pointer in the _lppEIDNewEntry_ parameter if you want to retain the new entry's entry identifier. 
    
## See also



[IMAPIProp::OpenProperty](imapiprop-openproperty.md)
  
[IMAPISupport::OpenEntry](imapisupport-openentry.md)
  
[PidTagCreateTemplates Canonical Property](pidtagcreatetemplates-canonical-property.md)
  
[IMAPISupport : IUnknown](imapisupportiunknown.md)

