---
title: "WrapCompressedRTFStreamEx"
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.service: office-online-server
ms.localizationpriority: medium
ms.assetid: 45abee1c-d7fb-b0f9-522d-8ba34caf1094
description: "Decompresses the body of an email message that's in compressed RTF indicates the format of the stream, and returns the decompressed or converted native stream."
---

# WrapCompressedRTFStreamEx

**Applies to**: Outlook 2013 | Outlook 2016
  
Decompresses the body of an email message that is in compressed Rich Text Format (RTF), indicates the format of the decompressed stream, optionally converts the decompressed stream to its native format, and returns either the decompressed stream or the converted native stream.
  
## Quick info

|Property |Value |
|:-----|:-----|
|Exported by:  <br/> |msmapi32.dll  <br/> |
|Called by:  <br/> |Client  <br/> |
|Implemented by:  <br/> |Outlook  <br/> |

```cpp
HRESULT __stdcall WrapCompressedRTFStreamEx( 
    LPSTREAM            lpCompressedRTFStream, 
    CONST RTF_WCSINFO   *pWCSInfo, 
    LPSTREAM            *lppUncompressedRTFStream, 
    RTF_WCSRETINFO      *pRetInfo); 

```

## Parameters

_lpCompressedRTFStream_
  
> [in] This is a pointer to a stream that is opened on the [PidTagRtfCompressed Canonical Property](pidtagrtfcompressed-canonical-property.md) of a message.

_pWCSInfo_
  
> [in] This is a pointer to a

   [RTF_WCSINFO](rtf_wcsinfo.md) structure that contains options for the function.

_lppUncompressedRTFStream_
  
> [out] This is a pointer to the location where a stream for the decompressed RTF is returned.

_pRetInfo_
  
> [out] This is a pointer to a [RTF_WCSRETINFO](rtf_wcsretinfo.md) structure that contains information about the format of the returned decompressed stream.

## Return values

S_OK
  
- The function call is successful.

MAPI_E_INVALID_PARAMETER
  
- This is returned if the **MAPI_NATIVE_BODY** flag is combined with the **MAPI_MODIFY** flag in the **ulFlags** field of the **RTF_WCSINFO** structure pointed at by _pWCSInfo_.

## Remarks

**WrapCompressedRTFStreamEx** allows you to access the body of an email message encapsulated in compressed RTF by decompressing the stream, returns the decompressed stream and its format, and optionally the native body stream. The native body stream can be in RTF, plain text, or HTML.
  
The Microsoft Office Outlook object model provides a **Body** property for **MailItem** objects and a [MailItem.BodyFormat Property (Outlook)](https://msdn.microsoft.com/library/f635a0bc-20b7-206c-f558-a4ca2519670f%28Office.15%29.aspx) that indicates the format of the body text. By design, a solution that is not trusted by Outlook invokes security dialog boxes generated by the Outlook Security Guard. Using the exported MAPI function **WrapCompressedRTFStreamEx** allows a solution to use MAPI instead of the Outlook object model and avoid these security dialog boxes.
  
Because the **MAPI\_NATIVE_BODY** flag cannot be combined with the **MAPI\_MODIFY** flag in the **ulFlags** field of the **RTF\_WCSINFO** structure pointed at by _pWCSInfo_, you can only access the native body stream in read-only mode. To access the native body stream in read/write mode, you should use the **WrapCompressedRTFStream** function.
  
## See also

- [Retrieve the Body of a Message in Compressed RTF and Convert It to Its Native Format](how-to-retrieve-the-body-of-a-message-in-compressed-rtf-and-convert.md)
