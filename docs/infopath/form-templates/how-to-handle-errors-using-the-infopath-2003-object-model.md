---
title: "Handle Errors Using the InfoPath 2003 Object Model"
 
 
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
 
keywords:
- infopath 2003-compatible form templates, handling errors,InfoPath 2003-compatible form templates, error handling,form templates [InfoPath 2007], error handling,error handling [InfoPath 2007], InfoPath 2003-compatible form templates
 
localization_priority: Normal
ms.assetid: eeb05205-d6f4-4931-b9a9-55a663bb1a25
description: "When creating custom applications, developers must often perform error handling that involves writing programming code to check for errors raised by the application or to create and raise custom errors. The InfoPath 2003-compatible object model supports error handling through the use of the ErrorObject object in association with the ErrorsCollection collection."
---

# Handle Errors Using the InfoPath 2003 Object Model

When creating custom applications, developers must often perform error handling that involves writing programming code to check for errors raised by the application or to create and raise custom errors. The InfoPath 2003-compatible object model supports error handling through the use of the [ErrorObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorObject.aspx) object in association with the [ErrorsCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorsCollection.aspx) collection. 
  
In InfoPath, errors can occur when data entered into a form fails XML schema validation, when a custom validation constraint fails, when an error is generated by the [ReportError](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.ReportError.aspx) method of the [DataDOMEventObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEventObject.aspx) object, or when an error is created using the [Add](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Add.aspx) method of the [ErrorsCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorsCollection.aspx) collection. 
  
## Overview of the ErrorsCollection Collection

The **ErrorsCollection** collection provides the following methods and properties, which form developers can use to manage the **ErrorObject** objects that the collection contains. 
  
|**Name**|**Description**|
|:-----|:-----|
|[Add](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Add.aspx) method  <br/> |Creates an **ErrorObject** object and adds it to the collection.  <br/> |
|[Delete](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Delete.aspx) method  <br/> |Deletes all **ErrorObject** objects associated with the specified XML node and condition name, except for custom errors added using the **ReportError** method.  <br/> |
|[DeleteAll](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.DeleteAll.aspx) method  <br/> |Deletes all **ErrorObject** objects contained in the collection.  <br/> |
|[Count](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Count.aspx) property  <br/> |Gets a count of the number of **ErrorObject** objects contained in the collection.  <br/> |
|[Item](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Item.aspx) property  <br/> |Gets a reference to an **ErrorObject** object based on the specified index number.  <br/> |
   
## Overview of the ErrorObject Object

The **ErrorObject** object provides the following properties, which form developers can use to access information about the error that was raised. 
  
|**Name**|**Description**|
|:-----|:-----|
|[ConditionName](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ConditionName.aspx) property  <br/> |Gets the name of the error condition, or returns **null**, depending on the type of **ErrorObject** object.  <br/> |
|[DetailedErrorMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.DetailedErrorMessage.aspx) property  <br/> |Gets or sets the detailed error message of the **ErrorObject** object.  <br/> |
|[ErrorCode](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ErrorCode.aspx) property  <br/> |Gets or sets the error code of the **ErrorObject** object.  <br/> |
|[Node](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.Node.aspx) property  <br/> |Gets a reference to the XML node associated with the **ErrorObject** object.  <br/> |
|[ShortErrorMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ShortErrorMessage.aspx) property  <br/> |Gets or sets the short error message of the **ErrorObject** object.  <br/> |
|[ErrorType](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ErrorType.aspx) property  <br/> |Gets the type of the **ErrorObject** object.  <br/> |
   
## Using the ErrorsCollection and ErrorObject

The **ErrorsCollection** collection is accessed through the [Errors](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument.Errors.aspx) property of the [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XDocument.aspx) object. The **ErrorsCollection** collection is associated with a form's underlying XML document so that when an error occurs, it occurs within the XML document. The following example demonstrates how a Visual C# **foreach** loop can be used to check the errors that may exist in a form's underlying XML document. If there are errors, the function loops through each of them, and, using the **ShortErrorMessage** property of the **ErrorObject** object, displays a message box to the user. 
  
```cs
public void CheckErrors(IXMLDOMNode xmlNode)
{
   foreach(ErrorObject err in thisXDocument.Errors)
   {
      if(xmlNode==err.Node)
         thisXDocument.UI.Alert("The following error has occured: "
             + err.ShortErrorMessage + ".");
   }
}
```

The preceding function could be called from one of the form's data validation event handlers. For example, when used in the [OnAfterChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnAfterChange.aspx) event handler for a field in the form, the call to the function would pass the XML node argument using the [Site](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.Site.aspx) property of the [DataDOMEventObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEventObject.aspx) object as follows. 
  
```cs
CheckErrors(e.Site);
```

In addition to handling errors generated by InfoPath, form developers can also generate custom errors by using the **ReportError** method of the **DataDOMEventObject** object, or by using the **Add** method of the **ErrorsCollection** collection. For information about using the **ReportError** or **Add** methods, click the methods at the beginning of this topic. 
  
## Handling Managed-Code Exceptions

You can use try-catch exception handling to handle exceptions raised in managed-code form template as shown in the following code example.
  
```cs
DataAdapters dataAdapters;
dataAdapters = thisXDocument.DataAdapters; 
XMLFileAdapterObject queryXMLFile = 
   (XMLFileAdapterObject)dataAdapters["form1"];
// Perform the query.
try
{
   queryXMLFile.Query();
}
catch (Exception ex)
{
   thisXDocument.UI.Alert("Failed to query.\n\n" + ex.Message);
}
// Perform the submit.
try
{
   queryXMLFile.Submit();
}
catch (Exception ex)
{
   thisXDocument.UI.Alert("Failed to submit.\n\n" + ex.Message);
}
```

If you do not use try-catch exception handling in your form code, InfoPath will display information about unhandled exceptions in the InfoPath error dialog box while debugging and previewing. 
  

